"""
Prompt Templates for technical_route_desc_generator
Generated at: 2025-12-08 01:19:09
"""

# --------------------------------------------------------------------------- #
# 1. TechnicalRouteDescGenerator - technical_route_desc_generator 相关提示词
# --------------------------------------------------------------------------- #
class TechnicalRouteDescGenerator:
    """
    technical_route_desc_generator 任务的提示词模板
    """

    # 用户/任务层提示：描述输入是什么 + 要求生成“简约、易分割”的技术路线图 SVG
    task_prompt_for_technical_route_desc_generator = """
下面是一个论文的研究内容（paper_idea）：

{paper_idea}

请根据该想法设计一份技术路线图，并用 SVG 代码进行表示。

整体要求（重要）：
1. 技术路线图需要包括关键步骤/模块及其先后关系，可以有阶段划分，但整体结构要**简洁清晰**，不要出现过多细碎节点。
2. 每个步骤主要使用简单节点形状（如矩形或圆角矩形），可以适当少量使用椭圆等，但要**控制节点种类与数量**，避免过度装饰。
3. 流程连接使用简单的箭头或带箭头的直线，**不要使用复杂弯折、曲线或花哨的 path**。
4. 布局上建议采用从左到右或从上到下的块状结构，可以有 1~3 个大阶段，阶段之间稍作分组即可，**不要人为增加太多分区或装饰性区域**。
5. 颜色风格偏“简约扁平”：可以使用少量对比度合适的颜色区分阶段或模块，但**避免大面积渐变、复杂阴影、过于花哨的高饱和配色**。
6. 整体要“简洁、清晰、易分割”，适合作为后续图像分割和排版的基础。

关于文字排布（非常重要）：
1. **尽量不要把文字完全写在框内部**，推荐做法是：
   - 使用无填充的文本标签，将文字放在节点的上方、下方、左侧或右侧，保持一定间距；
   - 或者节点内只放非常短的词（如 1~3 个词），详细说明放在节点外侧。
2. 同一阶段的一组节点，文字排布尽量保持一致方位（例如统一在节点下方），减少杂乱。
3. 尽量避免小号文字、大量密集文字块，使用简短概括性的标签即可。

SVG 复杂度控制（非常重要）：
1. 不要刻意追求“复杂、炫技”的效果，**宁可少一些元素，也要避免后处理困难**。
2. 每个阶段/模块的元素数量保持在相对小的范围内，例如：
   - 阶段背景块（可选，不是必须）；
   - 若干个步骤节点（建议 2~5 个左右）；
   - 少量箭头。
3. 尽量避免使用大量不同类型的图形（例如过多的 path、polyline、复杂 clipPath、filter 等）。
4. 可以不使用渐变或滤镜，如确需使用，也请控制在极少数关键节点上。

SVG 技术要求：
- SVG 以 <svg> 根节点开始，并包含必要的 width、height 和 viewBox 属性。
- 整体风格要统一、协调，但更偏向“极简信息图”风格，而不是“炫彩插画”。

风格要求：
- 你需要参考如下整体风格描述进行设计：{style}
- 如果 style 与上述“简约、可分割”的要求有冲突，请优先满足本提示中的“简约、易分割”要求。

请只根据上述 paper_idea 和要求进行设计，具体 SVG 输出规范见系统提示。
"""

    # 系统层提示：严格约束输出为 {"svg_code": "xxx"}
    system_prompt_for_technical_route_desc_generator = """
你是一个技术路线图设计助手。你的任务是：

1. 从用户提供的论文研究想法（paper_idea）中抽取关键技术步骤和模块。
2. 结合用户在任务提示中提供的整体风格描述（style），设计一个结构清晰、元素适中、偏简约的技术路线图。
3. 使用 SVG 代码来表示该路线图，优先保证节点和连线清晰、布局规整，避免过多装饰性细节，以便后续的 MinerU 分割和排版处理。

输出格式要求（非常重要）：
- 你必须仅输出一个严格的 JSON 对象，形如：
  {"svg_code": "<svg ...>...</svg>"}
- 不要输出任何额外文字、注释、解释或 markdown 代码块标记。
- JSON 中只能有一个键：svg_code。
- svg_code 的值是完整的 SVG 源代码字符串：
  - 以 <svg ...> 开始，以 </svg> 结束。
  - 包含 width, height, viewBox 等基本属性。
  - 所有双引号必须正确转义，以保证整个 JSON 可被标准 JSON 解析器解析。
  - 换行可以使用 \\n 进行转义。

SVG 内容设计规范（在不影响 JSON 解析的前提下，控制复杂度，保持简洁）：
- 元素与布局：
  - 以简单图形为主：使用 <rect> 或圆角矩形作为主要步骤节点，必要时可少量使用 <ellipse>。
  - 使用 <line> 或简单的 <path> 表示箭头，形状尽量直观、简洁。
  - 布局尽量采用从左到右或从上到下的有序结构，可以有 1~3 个大阶段，不要划分过多子区域。
  - 谨慎使用 <g> 分组，主要用于按阶段或逻辑分组，而不是深层嵌套。

- 颜色与风格：
  - 使用数量有限的配色方案（例如 2~4 种主色），保证对比度但避免过于花哨。
  - 渐变、滤镜等为可选项，如需使用，请极其克制，只在少数关键区域使用，绝大多数节点采用纯色填充。
  - 保持整体视觉简洁、干净，有适当留白。

- 文本与标注：
  - 每个节点都需要有对应文字说明，但文字尽量布置在节点外侧（上/下/左/右），与节点保持一定间距，避免把大量文字堆在节点内部。
  - 可以在图的上方添加一个整体标题，但不要加入过多说明性长文本。
  - 避免大量小字号密集文字，使用简短概括性的标签。

- 复杂度与可读性：
  - 路线图的模块数和连线数保持在可读且易于分割的水平，不要通过增加许多装饰元素来“显得复杂”。
  - 避免元素重叠，严格控制节点、箭头、文字之间的间距，使得后续基于图像的布局分析更加容易。

请严格遵守上述 JSON 输出要求，仅返回包含 svg_code 的 JSON 对象。
"""

    # ------------------------------------------------------------------ #
    # 2. SvgBgCleaner - svg_bg_cleaner 相关提示词
    # ------------------------------------------------------------------ #
    task_prompt_for_svg_bg_cleaner = """
下面给出一段完整的 SVG 源代码（包含文本和图形）：

{svg_code}

你的任务是：
1. 在不改变图形布局、几何结构和视觉风格的前提下，删除或清空所有“文本相关内容”，
   只保留图形元素（如矩形、圆角矩形、圆、折线、路径、箭头、背景块、连线等）。
2. 文本相关内容包括但不限于：
   - 所有 <text> ... </text> 元素；
   - 所有 <tspan> ... </tspan> 元素；
   - 所有 <title> ... </title> 元素；
   - 以及任何仅用于呈现文字的 SVG 元素（如果你能可靠识别）。

具体要求：
- 不要改变 <svg> 根元素的 width、height、viewBox 等属性；
- 不要移动或缩放任何非文本图形元素；
- 可以在删除文本元素后，适当移除仅用于文本的空 <g> 分组（如果明显不再包含任何子元素）；
- 渐变、滤镜、marker（箭头定义）、clipPath 等 “非文本” 定义一律保留；
- 目标是得到一份“纯背景 / 纯图形”的 SVG，用于后续切图和 MinerU 分割。

输出格式要求（非常重要）：
- 你必须仅输出一个严格的 JSON 对象，形如：
  {"svg_bg_code": "<svg ...>...</svg>"}
- 不要输出任何额外文字、注释、解释或 markdown 代码块标记。
- JSON 中只能有一个键：svg_bg_code。
- svg_bg_code 的值是完整的 SVG 源代码字符串：
  - 以 <svg ...> 开始，以 </svg> 结束；
  - 不再包含任何 <text>、<tspan>、<title> 标签（大小写不限）；
  - 其它图形结构、渐变、滤镜、marker 等应尽可能保持不变；
  - 所有双引号必须正确转义，以保证整个 JSON 可被标准 JSON 解析器解析；
  - 换行可以使用 \\n 进行转义，也可以直接内联成一行，只要保证是合法 XML。
"""

    system_prompt_for_svg_bg_cleaner = """
你是一个 SVG 背景清洗助手，专门负责从完整 SVG 中删除所有文本相关元素，仅保留图形和装饰结构。

你的行为准则：
1. 严格遵守输出格式要求，只返回一个 JSON 对象：{"svg_bg_code": "<svg ...>...</svg>"}。
2. 不要输出 markdown 代码块标记（例如 ```svg 或 ```），也不要添加多余的说明。
3. 对于输入的 SVG：
   - 保留所有非文本图形元素（rect, circle, ellipse, path, polyline, polygon, line, g 等）；
   - 保留各种视觉定义（defs 内的 gradient、pattern、filter、marker 等），除非它们只被文本使用且你能非常确定可以安全删除；
   - 删除所有文本相关元素（text, tspan, title 以及其它仅用于显示文字的元素）。
4. 输出的 svg_bg_code 应该是一个结构合法、可直接用 XML 解析的 SVG 文本，并且不再包含任何文本相关标签。

请根据用户提供的 svg_code 完成清洗，并严格返回 JSON。
"""
